<!DOCTYPE html>
<html class="h-full">
<head>
    <meta charset="UTF-8">
    <title>Opti AI | Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .bg-fixed-gif { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; object-fit: cover; filter: brightness(0.2); }
        .terminal-window {
            background: rgba(10, 10, 10, 0.9); backdrop-filter: blur(25px);
            border: 1px solid rgba(34, 211, 238, 0.2); width: 480px; height: 620px;
        }
        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-black text-white flex items-center justify-center h-screen overflow-hidden">

    <img src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExNHJueXF4eXF4eXF4eXF4eXF4eXF4eXF4eXF4eXF4eXF4eXF4JmVwPXYxX2ludGVybmFsX2dpZl9ieV9pZCZjdD1n/3o7TKMGpxx32dqRlzO/giphy.gif" class="bg-fixed-gif">

    <div class="terminal-window rounded-[2rem] shadow-2xl flex flex-col relative">
        
        <div class="p-6 border-b border-white/5 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="w-2 h-2 rounded-full bg-cyan-500 animate-pulse"></div>
                <span class="text-[10px] font-black uppercase tracking-[0.3em] text-cyan-500">Opti AI // Core</span>
            </div>
            <a href="/logout" class="w-7 h-7 rounded-full border border-red-500/30 flex items-center justify-center hover:bg-red-500/80 transition-all group">
                <span class="text-xs text-red-500 group-hover:text-white transition-colors">âœ•</span>
            </a>
        </div>

        <div id="chat-box" class="flex-1 overflow-y-auto p-8 space-y-6 text-sm font-mono leading-relaxed">
            <div class="text-cyan-400">{{ initial_msg }}</div>
        </div>

        <form id="chat-form" class="p-6 border-t border-white/5 flex gap-4">
            <input type="text" id="user-input" placeholder="Execute command..." autocomplete="off"
                class="flex-1 bg-transparent text-sm font-mono outline-none border-b border-white/10 focus:border-cyan-500 transition-all placeholder:text-gray-800">
            <button type="submit" class="text-cyan-500 text-[10px] font-black uppercase tracking-widest">Run</button>
        </form>
    </div>

    <script>
        const form = document.getElementById('chat-form');
        const box = document.getElementById('chat-box');

        form.onsubmit = async (e) => {
            e.preventDefault();
            const input = document.getElementById('user-input');
            const val = input.value;
            if(!val) return;
            input.value = '';

            box.innerHTML += `<div class="text-gray-600 font-mono">> ${val}</div>`;
            
            const resp = await fetch('/ask', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: `query=${encodeURIComponent(val)}`
            });
            const data = await resp.text();
            box.innerHTML += `<div class="text-cyan-400 font-mono">${data}</div>`;
            box.scrollTop = box.scrollHeight;
        };
    </script>
</body>
</html>
